# Рабочий процесс

## Проекты

Проект – набор мероприятий, нацеленных на решение какой-либо проблемы.

Для работы над проектом мы применяем версионированный (опционально) kanban – работаем не по фиксированным по продолжительности спринтам, а по [версиям](https://semver.org), которые уже в свою очередь привязаны к конкретным срокам.
Соответственно, доска проекта в таск трекере выглядит [так](#2-trello)

У каждого проекта есть свой руководитель – лид, который отвечает за постановку и согласование задач между исполнителями, командами и тим-лидами.

## Инструменты

### 1. Zulip

Корпоративный мессенджер, используется для всех коммуникаций внутри организации. Позволяет создавать стримы (аналог каналов Slack'а и чатов в Telegram) и группировать сообщения по темам в треды.

Сообщения бывают личными (от одного отправителя одному получателю, и доступны только отправителю и получателю) и публичные.
Публичные сообщения привязаны к стриму и к треду (не могут существовать просто так) и доступны всем участникам стрима/треда.

Наши стримы и треды организованны следующем образом:
  
- по стриму на проект, имя стрима совпадает с названием проекта
  - по треду на задачу проекта, при этом имя треда совпадает с названием задачи.
  - тред `general`, для обсуждений не связанных с конкретной задачей
- по стриму на команду для обсуждений, не связанных с конкретным проектом.
- стрим `convention`, в котором всегда есть ссылки на актуальные документы из этого репозитория
- общий стрим `general` для общения на все прочие темы.

Это выглядит примерно так:

```bash
admins – это стрим для команды администраторов
    | какая-то административная тема – а это тред, тут ведется обсуждение какой-то административной темы

unity-dev – стрим для unity-разработчиков
    | использование UniRx
    | ускоряем компиляцию проектов с сабстанс-материалами

project-a – стрим проекта project-a
    | task-1
    | fix/something
    | feature/add-cat
    | general

project-b
    | general
    ...

...

convention
    | onboarding
    | workflow – тут ссылка на этот документ
    ...

general
    | win-vs-macos
    | Зацените мой пет-проект
```

Мы стараемся использовать только публичные сообщения для обеспечения прозрачности рабочего процесса.

### 2. GitHub

### 3. Яндекc.Диск

## Команды

Мы образовываем команды по роду деятельности.

У каждой команды есть свой стрим (канал) в Zulip, предназначенный для общения внутри команды на темы, не связанные с конкретным проектом.

Если команда работает с GitHub, для них создается отдельная команда в GitHub (GitHub Team).

У каждой команды есть свой руководитель – тим-лид.

Так же мы называем командой проекта всех, кто работает над каким-либо проектом. Для них не создается отдельный чат и команда на GitHub, так как у каждого проекта и так есть чат.

## Задачи

Реализация каждого проекта состоит из последовательной реализации задач, ниже описан цикл жизни задачи.

### 1. Постановка задачи

В ходе обсуждения в треде "general" в стриме конкретного проекта возникает понимание необходимости реализации чего-либо – это и есть задача, и она появилась. Для более подробного обсуждения создается тред с названием задачи, в который переносятся сообщения, которые привели к постановке задачи.

Далее, создается карточка задачи в таск-трекере, которая прикрепляется к треду задачи. Все обсуждения в треде синхронизируются с таск-трекером. Уведомления об изменении задачи приходят в тред задачи.

### 2. Принятие задачи в работу

При принятие задачи в работу кем-либо, исполнитель подтверждает что ознакомлен с задачей, помечает в таск-трекере в карточке задачи себя исполнителем и переносит карточку в колонку `Doing`

### 3. Проверка задачи

Как только исполнитель считает, что задача сделана, он перемещает ее в колонку `In review`. Лид проекта проверяет что зада выполнена, и либо отправляет ее на [доработку](#2-принятие-задачи-в-работу), либо [принимает задачу](#4-завершение-работы-над-задачей).

### 4. Завершение работы над задачей

Если задача принята лидом проекта, карточка задачи переносится в колонку `Done` той версии, к которой относится задача, или в колонку `Done` последний версии, если задача не привязана к вверсии.

## Backlog

## Работа со сторонними сервисами из чата

Для повышения удобства работы и скорости взаимодействия существуют следующие команды для сторонних сервисов. Основной целью является сбор уведомлений и синхронизация сообщений/комментариев. Прочие команды существуют для удобства.

### 1. Команды чат-бота для Trello

- Уведомления
  - `/tt notifications link <ссылка на доску>` – связывает доску с тредом, чтобы получать уведомления о всех действиях на доске
  - `/tt notifications unlink <ссылка на доску>` – отвязывает доску от треда
- Привязка карточек
  - `/tt link <ссылка на карточку>` – связывает карточку с тредом, если до этого с тредом была связана другая карточка – она автоматически отвязывается
  - `/tt unlink <ссылка на карточку>` – отвязывает карточку от треда
- Работа с колонкой карточки
  - `/tt <ссылка на карточку> column` – печатает имя текущей колонки карточки
  - `/tt <ссылка на карточку> column set <имя колонки>` – переносит карточку в колонку с заданным именем
- Работа с тегами карточки
  - `/tt <ссылка на карточку> tag` – выводит теги карточки
  - `/tt <ссылка на карточку> tag add <tag>` – добавляет тег карточке
  - `/tt <ссылка на карточку> tag remove <tag>` – удаляет тег карточки
- Работа с дедлайнами карточек
  - `/tt <ссылка на карточку> deadline` – выводит дедлайн для карточки. Ссылка на карточку может быть опущена, если команда запущена из треда, привязанного к   карточке
  - `/tt <ссылка на карточку> deadline set dd.mm.yyyy` – устанавливает дедлайн карточке

Для следующих команд ссылка на карточку/доску опциональна, если команда запущена из треда, к которому уже привязана карточка/доска:

- `/tt notifications unlink <ссылка на доску>`
- `/tt unlink <ссылка на карточку>`
- `/tt <ссылка на карточку> column`
- `/tt <ссылка на карточку> column set <имя колонки>`
- `/tt <ссылка на карточку> tag`
- `/tt <ссылка на карточку> tag add <tag>`
- `/tt <ссылка на карточку> tag remove <tag>`
- `/tt <ссылка на карточку> deadline set dd.mm.yyyy`

### 2. Команды чат-бота для GitHub

- Работ с репозиторием
  - `/gh repo link <имя/ссылка на репозиторий>` – связывает репозиторий со стримом
  - `/gh repo unlink <имя/ссылка на репозиторий>` – отвязывает репозиторий от стрима
- Работа с PR
  - `/gh pr link <имя/номер/ссылка на pr>` – связывает PR с тредом
  - `/gh pr unlink <имя/номер/ссылка на pr>` – отвязывает PR от тредом
  - `/gh pr <имя/номер/ссылка на pr> request-changes <сообщение>` – запросить изменения в PR
  - `/gh pr <имя/номер/ссылка на pr> approve` – одобрить PR
  - `/gh pr <имя/номер/ссылка на pr> merge` – смержить PR
  - `/gh pr <имя/номер/ссылка на pr> comment <сообщение>` – добавить комментарий к PR (если тред не связан с PR)
- Работа с релизами
  - `/gh release link <имя/ссылка на репозиторий>` – связать уведомления о релизах с тредом
  - `/gh release unlink <имя/ссылка на репозиторий>` – отвязать уведомления о релизах от треда
  - `/gh release <имя/ссылка на репозиторий>` – вывести список релизов
- Работа с CI
  - `/gh ci link <имя/ссылка на репозиторий>`  – связывает уведомления CI с тредом
  - `/gh ci unlink <имя/ссылка на репозиторий>` – отвязывает уведомления CI от треда
  - `/gh ci <имя/ссылка на репозиторий> <ref>` – вывести текущий статус CI для ref'а (опционально: хеш коммита, ссылка на коммит, имя ветки, ссылка на ветку, номер pr, ссылка на pr)
  - `/gh ci run <имя/ссылка на репозиторий> <workflow-name> <ref>` – запустить указанный workflow для ref'а в репозитории. Если workflow создало артефакты, пришлет артефакты.

Для следующих команд ссылка на репозиторий/команду/pr является опциональной, если команда запущена из треда/стрима, к которому привязан репозиторий/команда/pr:

- `/gh repo unlink <имя/ссылка на репозиторий>`
- `/gh pr unlink <имя/номер/ссылка на pr>`
- `/gh pr <имя/номер/ссылка на pr> request-changes <сообщение>`
- `/gh pr <имя/номер/ссылка на pr> approve`
- `/gh pr <имя/номер/ссылка на pr> merge`
- `/gh pr <имя/номер/ссылка на pr> comment <сообщение>`
- `/gh release <имя/ссылка на репозиторий>`
- `/gh release unlink <имя/ссылка на репозиторий>`
- `/gh ci <имя/ссылка на репозиторий> <ref>`
- `/gh ci unlink <имя/ссылка на репозиторий>`

## Комментарии

Под синхронизацией подразумевается двухсторонняя синхронизация, если не указано иное
